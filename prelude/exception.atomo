macro action handle: (branches: Block) :=
  { matches = `Block new: (branches contents .. [`(e -> raise: e)])
    `(~action catch: { e | e match: ~matches })
  } call

macro a handle: (b: Block) ensuring: (c: Block) :=
  `({ ~a handle: ~b } ensuring: ~c)

v ensuring: p do: b :=
  { b call: [v] } ensuring: { p call: [v] }
